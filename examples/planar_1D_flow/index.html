<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>First example: one-dimensional planar flow · WAVI.jl</title><meta name="title" content="First example: one-dimensional planar flow · WAVI.jl"/><meta property="og:title" content="First example: one-dimensional planar flow · WAVI.jl"/><meta property="twitter:title" content="First example: one-dimensional planar flow · WAVI.jl"/><meta name="description" content="Documentation for WAVI.jl."/><meta property="og:description" content="Documentation for WAVI.jl."/><meta property="twitter:description" content="Documentation for WAVI.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="WAVI.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">WAVI.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../installation_instructions/">Installation instructions</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>First example: one-dimensional planar flow</a><ul class="internal"><li><a class="tocitem" href="#Install-dependencies"><span>Install dependencies</span></a></li><li><a class="tocitem" href="#Instantiating-and-configuring-a-model"><span>Instantiating and configuring a model</span></a></li><li><a class="tocitem" href="#Updating-the-model-state"><span>Updating the model state</span></a></li><li><a class="tocitem" href="#Visualizing-the-solutions"><span>Visualizing the solutions</span></a></li><li><a class="tocitem" href="#Advancing-in-time:-running-a-simulation"><span>Advancing in time: running a simulation</span></a></li><li><a class="tocitem" href="#Outputting-the-solution"><span>Outputting the solution</span></a></li><li><a class="tocitem" href="#Visualizing-the-results"><span>Visualizing the results</span></a></li></ul></li><li><a class="tocitem" href="../mismip_plus/">MISMIP+ part one: grounding lines on overdeepened bed</a></li><li><a class="tocitem" href="../mismip_plus_retreat/">MISMIP+ part two: retreat experiments</a></li><li><a class="tocitem" href="../bumpy_bed/">Two-dimensional flow on a bumpy bed</a></li><li><a class="tocitem" href="../melt_parametrizations/">Melt rate parametrizations</a></li><li><a class="tocitem" href="../stochastic_forcing/">Ice sheet retreat under stochastic forcing</a></li><li><a class="tocitem" href="../WAIS/">Real world: West Antarctic Ice Sheet</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Physics</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../physics/overview/">Overview</a></li><li><a class="tocitem" href="../../physics/governing_equations/">Governing Equations</a></li><li><a class="tocitem" href="../../physics/melting/">Basal Melt Rate Parametrizations</a></li></ul></li><li><a class="tocitem" href="../../numerical_procedure/numerical_procedure/">Numerical Implementation</a></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../API/overview/">Overview</a></li><li><a class="tocitem" href="../../API/simulations/">Simulations</a></li><li><a class="tocitem" href="../../API/model/">Models</a></li><li><a class="tocitem" href="../../API/timestepping_params/">Timestepping Parameters</a></li><li><a class="tocitem" href="../../API/output_writing/">Output Writing</a></li><li><a class="tocitem" href="../../API/grid/">Grid</a></li><li><a class="tocitem" href="../../API/solver_parameters/">Solver Parameters</a></li><li><a class="tocitem" href="../../API/params/">Physical Parameters</a></li><li><a class="tocitem" href="../../API/initial_conditions/">Initial Conditions</a></li><li><a class="tocitem" href="../../API/fields/">Fields</a></li><li><a class="tocitem" href="../../API/melt_rate_models/">Basal Melt Rate Models</a></li></ul></li><li><a class="tocitem" href="../../mitgcm_coupling/">MITgcm coupling</a></li><li><a class="tocitem" href="../../contributing/">Contributors guide</a></li><li><a class="tocitem" href="../../test/">Unit Testing</a></li><li><a class="tocitem" href="../../contact/">Contact us</a></li><li><a class="tocitem" href="../../references/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>First example: one-dimensional planar flow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>First example: one-dimensional planar flow</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/WAVI-ice-sheet-model/WAVI.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/WAVI-ice-sheet-model/WAVI.jl/blob/main/docs/src/examples/planar_1D_flow.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Planar-One-Dimensional-Flow"><a class="docs-heading-anchor" href="#Planar-One-Dimensional-Flow">Planar One-Dimensional Flow</a><a id="Planar-One-Dimensional-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#Planar-One-Dimensional-Flow" title="Permalink"></a></h1><p>This a WAVI.jl&#39;s simplest example: flow down a flat plane in one horizontal dimension. This example demonstrates how to:</p><ul><li>load <code>WAVI.jl</code></li><li>instantiate an <code>WAVI.jl</code> model</li><li>update ice velocities</li><li>output solutions</li><li>time-step a model forward</li><li>look at results</li></ul><h2 id="Install-dependencies"><a class="docs-heading-anchor" href="#Install-dependencies">Install dependencies</a><a id="Install-dependencies-1"></a><a class="docs-heading-anchor-permalink" href="#Install-dependencies" title="Permalink"></a></h2><p>First let&#39;s make sure we have all required packages installed.</p><pre><code class="language-julia hljs">using Pkg
Pkg.add(PackageSpec(url=&quot;https://github.com/WAVI-ice-sheet-model/WAVI.jl.git&quot;, rev = &quot;main&quot;))
Pkg.add(&quot;Plots&quot;)
using WAVI, Plots</code></pre><h2 id="Instantiating-and-configuring-a-model"><a class="docs-heading-anchor" href="#Instantiating-and-configuring-a-model">Instantiating and configuring a model</a><a id="Instantiating-and-configuring-a-model-1"></a><a class="docs-heading-anchor-permalink" href="#Instantiating-and-configuring-a-model" title="Permalink"></a></h2><p>We first build a WAVI <code>model</code>, by passing it a grid containing information about the problem we would like to solve.</p><p>Below, we build a grid with 300 grid points in the <code>x</code> direction. We use 2 grid points in the <code>y</code> direction which is equivalent to being one-dimensional. This grid has a resolution of 12km.</p><pre><code class="language-julia hljs">grid = Grid(nx = 300, ny = 2, dx = 12000.0, dy = 12000.0);</code></pre><p>Next, we write a function which defines the bed (note that WAVI.jl accepts both functions and arrays of the same size as the grid as bed inputs, but here we&#39;ll use a function for simplicity). You can read more about functions in julia <a href="https://docs.julialang.org/en/v1/manual/functions/">here</a></p><pre><code class="language-julia hljs">function bed_elevation(x,y)  
    B = 720 - 778.5 * x ./ (750e3)
    return B
end</code></pre><p>This bed drops a height of 778.5m in every 750km, where the latter is a typical length scale for the Antarctic ice sheet.</p><p>Next we specify physical parameters via a <code>Params</code> object. In this case, we set the accumulation rate (the net snowfall) and leave all other parameters at their default values. </p><pre><code class="language-julia hljs">params = Params(accumulation_rate = 0.3);</code></pre><p>Let&#39;s also set the initial thickness (i.e. at the start of the simulation) of the ice to be 300m everywhere. Initial conditions in WAVI are set via <code>InitialConditions</code> objects:</p><pre><code class="language-julia hljs">initial_conditions = InitialConditions(initial_thickness = 300. .* ones(grid.nx, grid.ny));</code></pre><p>Now we are ready to build a <code>Model</code> by assembling these pieces:</p><pre><code class="language-julia hljs">model = Model(grid = grid, bed_elevation = bed_elevation, params = params, initial_conditions = initial_conditions);</code></pre><h2 id="Updating-the-model-state"><a class="docs-heading-anchor" href="#Updating-the-model-state">Updating the model state</a><a id="Updating-the-model-state-1"></a><a class="docs-heading-anchor-permalink" href="#Updating-the-model-state" title="Permalink"></a></h2><p>Having built the model, we can solve for the ice velocities associated with the geometry we set via the initial conditions. To do so, we use the <code>update_state!</code> function, which takes a model and updates the velocities to be in line with the geometry.</p><pre><code class="language-julia hljs">update_state!(model)</code></pre><h2 id="Visualizing-the-solutions"><a class="docs-heading-anchor" href="#Visualizing-the-solutions">Visualizing the solutions</a><a id="Visualizing-the-solutions-1"></a><a class="docs-heading-anchor-permalink" href="#Visualizing-the-solutions" title="Permalink"></a></h2><p>Now let&#39;s plot the ice profile and ice velocity, starting with the bed. We&#39;ll use julia&#39;s <a href="https://docs.juliaplots.org/stable/">Plots.jl</a> package to plot. Note that we make plot objects sequentially, and then use the <code>display</code> command to show them.</p><pre><code class="language-julia hljs">ice_plot = plot(model.grid.xxh[:,1]/1e3, model.fields.gh.b[:,1], 
                linewidth = 2,
                linecolor = :brown,
                label = &quot;bed&quot;,
                xlabel = &quot;x (km)&quot;,
                ylabel = &quot;z (m)&quot;);</code></pre><p>Then we add the ice surface...</p><pre><code class="language-julia hljs">plot!(ice_plot, model.grid.xxh[:,1]/1e3, model.fields.gh.s[:,1],
                linewidth = 2,
                linecolor = :blue,
                label = &quot;ice surface&quot;);</code></pre><p>...and finally the ice base</p><pre><code class="language-julia hljs">plot!(ice_plot, model.grid.xxh[:,1]/1e3, model.fields.gh.s[:,1] .- model.fields.gh.h[:,1],
                linewidth = 2,
                linecolor = :red,
                label = &quot;ice base&quot;);

display(ice_plot)</code></pre><center><img src="../assets/example-plots/planar_1D_flow/ice-profile.png" style="max-width: 100%" /></center><p>We see that the ice shelf goes afloat when the ice base is approximately 270m below sea level, which fits which Archimedean floatation principles: 270m is the product of the ratio of the densities of ice (about 900 km/m^3) and ocean (about 1000 kg/m^3) with the ice thickness (300m).</p><p>Now lets have a look at the velocity in the ice. We&#39;ll make a new plot for this:</p><pre><code class="language-julia hljs">vel_plot = plot(model.grid.xxh[:,1]/1e3, model.fields.gh.u[:,1],
                linewidth = 2,
                label = &quot;ice velocity&quot;,
                xlabel = &quot;x (km)&quot;,
                ylabel = &quot;ice velocity (m/yr)&quot;);
display(vel_plot)</code></pre><center><img src="../assets/example-plots/planar_1D_flow/ice-velocity.png" alt="" title="" style="max-width: 100%" /></center><p>We see that ice velocities are very small (but non-zero, although not obvious from the plot) in the grounded ice, where friction between the ice and the bed restrains the flow. In the shelf, where there is no basal friction, velocities increase linearly to a maximum of 12km/yr (very fast!) at the downstream end of the shelf.</p><h2 id="Advancing-in-time:-running-a-simulation"><a class="docs-heading-anchor" href="#Advancing-in-time:-running-a-simulation">Advancing in time: running a simulation</a><a id="Advancing-in-time:-running-a-simulation-1"></a><a class="docs-heading-anchor-permalink" href="#Advancing-in-time:-running-a-simulation" title="Permalink"></a></h2><p>Now, let&#39;s think about advancing time. To do so, we set up a simulation via a <code>Simulation</code> object, which can be time-stepped to advance the simulation and also manages output.</p><p>First we define a <code>TimesteppingParams</code> object, which holds parameters related to timestepping. Let&#39;s set the model to run for 10 years with a timestep of 0.5 years:</p><pre><code class="language-julia hljs">timestepping_params = TimesteppingParams(dt = 0.5, end_time = 100.);</code></pre><p>(Note that the end time <code>end_time</code> and timestep <code>dt</code> must be floating point numbers – we&#39;re working on fixing this!). Now we can build the <code>Simulation</code> object...</p><pre><code class="language-julia hljs">simulation = Simulation(model = model, timestepping_params = timestepping_params);</code></pre><p>...and run it, which will timestep the solution for 100 years </p><pre><code class="language-julia hljs">run_simulation!(simulation);</code></pre><p>Our simulation ran! The object <code>simulation</code> holds all the information about the state at time 10 years. Note that the current model state can be accessed via <code>simulation.model</code>, so we could use the above plotting commands to look at the geometry and velocity, if we wanted. </p><h2 id="Outputting-the-solution"><a class="docs-heading-anchor" href="#Outputting-the-solution">Outputting the solution</a><a id="Outputting-the-solution-1"></a><a class="docs-heading-anchor-permalink" href="#Outputting-the-solution" title="Permalink"></a></h2><p>Our simulation ran successfully, but we don&#39;t have any information about what happened. We get around this by outputting the solution regularly. To do so, we first make a clean folder where solution files will go:</p><pre><code class="language-julia hljs">folder = &quot;planar_one_dimensional_flow&quot; # the name of the directory
mkdir(folder) #make the folder</code></pre><p>What to output and when to output it is specified by an instance of an <code>OutputParams</code> objects. Let&#39;s set one up so that the ice thickness, (unchanging) bed, ice surface and ice velocity is output every year, including at the first timestep:</p><pre><code class="language-julia hljs">output_params = OutputParams(outputs = (h = model.fields.gh.h,u = model.fields.gh.u, b = model.fields.gh.b,s = model.fields.gh.s), #which fields to output
                            output_freq = 10.,    #how frequently to output
                            output_path = folder, #where to store the results
                            output_start = true); #flag to output the state before the first timestep</code></pre><p>Note that the <code>outputs</code> keyword argument takes a named tuple, which points to the locations of fields that are to be outputted. As in the <code>timestepping_params</code>, the output frequency must be a floating point number.</p><p>Let&#39;s build a new simulation, which knows about the outputting via the <code>OutputParams</code> object</p><pre><code class="language-julia hljs">simulation = Simulation(model = model, timestepping_params = timestepping_params, output_params = output_params)</code></pre><p>...and run it (nb this might take a few mins, depending on the spec of your pc!)</p><pre><code class="language-julia hljs">run_simulation!(simulation)</code></pre><p>The simulation will run and output the results as it goes.</p><h2 id="Visualizing-the-results"><a class="docs-heading-anchor" href="#Visualizing-the-results">Visualizing the results</a><a id="Visualizing-the-results-1"></a><a class="docs-heading-anchor-permalink" href="#Visualizing-the-results" title="Permalink"></a></h2><p>Let&#39;s look at how the shape of the ice sheet changes during the simulation. We&#39;ll plot the surface elevation for each of the output files (i.e. every 10 years). To do so, we first have to fetch the results: we&#39;ll loop over the output files and put the thickness and surface info a matrix</p><pre><code class="language-julia hljs">files = [joinpath(folder, file) for file in readdir(folder) if endswith( joinpath(folder, file), &quot;.jld2&quot;) ] ;
nout = length(files);
h_out = zeros(simulation.model.grid.nx, nout);
surface_out = zeros(simulation.model.grid.nx, nout);
base_out = zeros(simulation.model.grid.nx, nout);
t_out = zeros(1,nout);

for i = 1:nout
    d = load(files[i]);
    h_out[:,i] = d[&quot;h&quot;][:,1];
    base_out[:,i] = d[&quot;s&quot;][:,1] .- d[&quot;h&quot;][:,1];
    surface_out[:,i] = d[&quot;s&quot;][:,1];
    t_out[i] = d[&quot;t&quot;];
end</code></pre><p>Now lets make the plot.</p><pre><code class="language-julia hljs">pl = Plots.plot(simulation.model.grid.xxh[:,1], simulation.model.fields.gh.b[:,1], 
                    linecolor = :brown,
                    xlabel = &quot;x (km)&quot;,
                    ylabel = &quot;z (m)&quot;, 
                    legend = :none,
                    ylim=(-500,500))
Plots.plot!(pl,simulation.model.grid.xxh[:,1], surface_out, legend = :none, linecolor = :blue)
Plots.plot!(pl,simulation.model.grid.xxh[:,1], base_out, legend = :none, linecolor = :red)</code></pre><p>As time proceeds, the ice sheet accelerates, causing thinning. </p><center><img src="../assets/example-plots/planar_1D_flow/ice-evolution.png" alt="" title="" style="max-width: 100%" /></center><p>Finally, we clear up the files we just outputted</p><pre><code class="language-julia hljs">rm(folder, force = true, recursive = true);</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../installation_instructions/">« Installation instructions</a><a class="docs-footer-nextpage" href="../mismip_plus/">MISMIP+ part one: grounding lines on overdeepened bed »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 16 October 2025 08:16">Thursday 16 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
